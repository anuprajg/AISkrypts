// 0.0avar artboardsWidth = 1920var artboardsHeight = 1080var artboardColumns = 5var artboardRows = 20function prepareArtboards (newDocument, count) {    if (count > 100) {        alert ('Please reduce the selection to <= 100')        return    };    var myDoc = newDocument;    var count = count;     for(i=0;i<(count); i++)    {        myDoc.artboards.add ([i*i+10, i*i+10, artboardsWidth + i*i+10, - (artboardsHeight - (i*i+10))]);    }    myDoc.artboards.remove(0)    myDoc.rearrangeArtboards (DocumentArtboardLayout.GridByRow,artboardColumns,artboardRows,false);}  // Main Functionfunction execute(){    if (app.documents.length == 0)    {        alert('No document open', 'Error');        return;    }        if (app.activeDocument.selection.length == 0)    {        alert('Nothing selected', 'Error');        return;    }    // determine destination    var docRef = app.activeDocument;    var docRefSelection = docRef.selection    var newDocument = app.documents.add(docRef.DocumentColorSpace);    if (docRefSelection.length > 100) {        alert ('Please reduce the selection to <= 100')        return    };    prepareArtboards(newDocument, docRefSelection.length)    // Loop through the selection and export selected    for (var i=0; i< docRefSelection.length; i++)    {        // Set selected stuff for easy naming        var selectedStuff = docRefSelection[i];        // snap position to pixels        //selectedStuff.position = [ Math.round(selectedStuff.position[0]), Math.round(selectedStuff.position[1]) ];        try        {          var newLayer;          // Use first layer if there is one, otherwise, create a new one          if(newDocument.layers) {            newLayer = newDocument.layers[0];          }          else {            newLayer = newDocument.layers.add();          }        var sel = selectedStuff.duplicate(newLayer, ElementPlacement.PLACEATBEGINNING);        var activeAB = newDocument.artboards[i];                var docLeft = activeAB.artboardRect[0];        var docTop = activeAB.artboardRect[1];        var selVB = sel.visibleBounds;          var selVw = selVB[2]-selVB[0];          var selVh = selVB[1]-selVB[3];            var selGB = sel.geometricBounds;          var selGw = selGB[2]-selGB[0];          var selGh = selGB[1]-selGB[3];          var deltaX = selVw-selGw;          var deltaY = selVh-selGh;          sel.width = artboardsWidth-deltaX; // width is Geometric width, so we need to make it smaller...to accomodate the visible portion.          sel.height = (selVh) * (artboardsWidth/selVw);          sel.top = docTop - (artboardsHeight - sel.height) / 2; // Top is actually Visible top          sel.left = docLeft; // dito for Left          //newDocument.fitArtboardToSelectedArt(i);        //alert(new Array(docLeft,docTop,docLeft+artboardsWidth,docTop+artboardsHeight))        //newDocument.artboards[i].artboardRect = new Array (docLeft, docTop, docLeft+artboardsWidth, docTop+artboardsHeight)                sel.selected = false        newDocument.selection.selected = false        //var scaleTo = width / (artboardBound[2] - artboardBound[0]) * 100;        //alert(scaleTo);        }        catch(e) {            alert(e)        }    }}execute();