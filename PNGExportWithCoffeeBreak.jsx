// 0.1// Set Resolution herevar width = 1920.0;var height = 1080.0;// Scale to Width or else heightvar scaleToWidth = true;// Function to set the export to PNGfunction exportFileToPNG(dest, artBoardIndex, scaleTo){    var exportOptions = new ExportOptionsPNG24(); // or ExportOptionsPNG8    var type = ExportType.PNG24; // or ExportType.PNG8    var file = new File(dest + ".png");    exportOptions.artBoardClipping = true;    exportOptions.antiAliasing = true;    exportOptions.transparency = true;    exportOptions.verticalScale = scaleTo;    exportOptions.horizontalScale = scaleTo;    exportOptions.qualitySetting = 72;    exportOptions.saveMultipleArtboards = false;    exportOptions.artboardRange = "" + artBoardIndex;    app.activeDocument.exportFile( file, type, exportOptions );}// Main Functionfunction execute(){    if (app.documents.length == 0)    {        alert('No document open', 'Error');        return;    }        if (app.activeDocument.selection.length == 0)    {        alert('Nothing selected', 'Error');        return;    }    // determine destination    var docRef = app.activeDocument;    var destFolder = docRef.path;    if(destFolder == ""){        destFolder = Folder.selectDialog('Select the folder to export to:');    }    // Loop through the selection and export selected    for (var i=0; i< app.activeDocument.selection.length; i++)    {                // Set selected stuff for easy naming        var selectedStuff = app.activeDocument.selection[i];        // snap position to pixels        selectedStuff.position = [ Math.round(selectedStuff.position[0]), Math.round(selectedStuff.position[1]) ];        if(destFolder)        {            try            {              var newDocument = app.documents.add(docRef.DocumentColorSpace);              var newLayer;              // Use first layer if there is one, otherwise, create a new one              if(newDocument.layers) {                newLayer = newDocument.layers[0];              }              else {                newLayer = newDocument.layers.add();              }            selectedStuff.duplicate(newLayer, ElementPlacement.PLACEATBEGINNING);          try {              newDocument.fitArtboardToSelectedArt(0);            }            catch(e) {            }            var artboardBound = newDocument.artboards[0].artboardRect;            var scaleTo = width / (artboardBound[2] - artboardBound[0]) * 100;            //alert(scaleTo);                exportFileToPNG(destFolder + "/" + docRef.name + i, newDocument.artboards.length, scaleTo);                newDocument.close(SaveOptions.DONOTSAVECHANGES);            }            catch(e) {}        }    }}execute();